<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS Pro Simulation</title>
    <style>
        :root {
            --bg-overlay: rgba(0, 0, 0, 0.1);
            --glass-light: rgba(255, 255, 255, 0.65);
            --glass-dark: rgba(40, 40, 40, 0.85);
            --border-light: rgba(255, 255, 255, 0.4);
            --border-dark: rgba(255, 255, 255, 0.1);
            --shadow-active: 0 20px 50px rgba(0,0,0,0.3);
            --shadow-inactive: 0 5px 15px rgba(0,0,0,0.1);
            --term-bg: #1e1e1e;
            --term-text: #4af626;
        }

        * { box-sizing: border-box; user-select: none; outline: none; }
        
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            /* Default Wallpaper: High Res Mountain */
            background-image: url('https://images.unsplash.com/photo-1493246507139-91e8fad9978e?ixlib=rb-4.0.3&auto=format&fit=crop&w=2940&q=80');
            background-size: cover;
            background-position: center;
            transition: background-image 0.5s ease-in-out;
        }

        /* --- Menu Bar --- */
        .menubar {
            height: 30px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 13px;
            font-weight: 600;
            color: white; /* Text shadow for readability on bright walls */
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            position: absolute;
            top: 0;
            width: 100%;
            z-index: 9999;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .left-menu, .right-menu { display: flex; gap: 20px; }
        
        /* --- Window System --- */
        .window {
            position: absolute;
            background: #f5f5f5;
            border-radius: 10px;
            box-shadow: var(--shadow-active);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 300px;
            min-height: 200px;
            border: 1px solid rgba(0,0,0,0.1);
            transition: transform 0.2s ease, opacity 0.2s ease, width 0.3s, height 0.3s, top 0.3s, left 0.3s;
            animation: popIn 0.2s cubic-bezier(0.17, 0.67, 0.39, 1.2);
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .window.minimized {
            transform: scale(0) translateY(500px);
            opacity: 0;
            pointer-events: none;
        }

        .window-header {
            height: 40px;
            background: linear-gradient(to bottom, #e6e6e6, #dcdcdc);
            border-bottom: 1px solid #ccc;
            display: flex;
            align-items: center;
            padding: 0 15px;
            cursor: default;
        }

        .traffic-lights { display: flex; gap: 8px; }
        .dot { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; position: relative; }
        .dot.close { background: #ff5f57; border: 1px solid #e0443e; }
        .dot.min { background: #febc2e; border: 1px solid #d89e24; }
        .dot.max { background: #28c840; border: 1px solid #1aab29; }
        
        /* Hover symbols for dots */
        .traffic-lights:hover .dot.close::after { content: '√ó'; position: absolute; top: -2px; left: 2px; font-size: 10px; color: #550000; }
        .traffic-lights:hover .dot.min::after { content: '‚Äì'; position: absolute; top: -3px; left: 2px; font-size: 10px; color: #553300; }
        .traffic-lights:hover .dot.max::after { content: '+'; position: absolute; top: -2px; left: 2px; font-size: 10px; color: #004400; }

        .window-title {
            flex-grow: 1;
            text-align: center;
            font-size: 13px;
            color: #444;
            margin-right: 54px; /* offset lights */
            font-weight: 600;
        }

        .window-body {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
            background: #fff;
        }

        /* --- Terminal Specifics --- */
        .term-body {
            background: var(--term-bg);
            color: white;
            font-family: "SF Mono", "Monaco", "Courier New", monospace;
            padding: 10px;
            font-size: 14px;
            overflow-y: auto;
            height: 100%;
        }
        .term-line { margin-bottom: 4px; line-height: 1.4; }
        .term-input-line { display: flex; }
        .prompt { color: #28c840; margin-right: 8px; }
        .term-input { 
            background: transparent; 
            border: none; 
            color: white; 
            font-family: inherit; 
            font-size: inherit; 
            flex-grow: 1; 
            caret-color: white;
        }

        /* --- Finder Specifics --- */
        .finder-nav {
            height: 40px;
            background: #f0f0f0;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 15px;
            gap: 15px;
        }
        .nav-btn { font-size: 18px; cursor: pointer; color: #555; }
        .nav-btn:hover { color: #000; }
        .path-display { font-size: 13px; color: #666; font-weight: 500;}
        
        .finder-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            padding: 20px;
            gap: 10px;
        }
        .f-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
        }
        .f-icon:hover { background: #e0e0e0; }
        .f-icon.selected { background: #ccc; }
        .folder-img { font-size: 40px; margin-bottom: 5px; }
        .f-name { font-size: 12px; text-align: center; color: #333; word-break: break-word; }

        /* --- Settings (Wallpaper) --- */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            padding: 20px;
            gap: 15px;
            height: 100%;
            overflow-y: auto;
        }
        .wall-option {
            height: 100px;
            border-radius: 8px;
            background-size: cover;
            background-position: center;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.1s;
        }
        .wall-option:hover { transform: scale(1.02); }
        .wall-option:active { border-color: #007AFF; }

        /* --- Dock --- */
        .dock-wrapper {
            position: absolute;
            bottom: 10px;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 10000;
        }
        .dock {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            padding: 8px;
            display: flex;
            gap: 12px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .dock-app {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            cursor: pointer;
            transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        .dock-app:hover { transform: scale(1.2) translateY(-10px); }
        
        /* Tooltip */
        .dock-app:hover::after {
            content: attr(data-name);
            position: absolute;
            top: -35px;
            background: rgba(0,0,0,0.7);
            color: white;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            pointer-events: none;
            white-space: nowrap;
        }

        /* App Icons */
        .icon-finder { background: linear-gradient(to bottom, #d4ebf2, #e0e0e0); }
        .icon-term { background: #333; color: #28c840; font-family: monospace; font-size: 24px; font-weight: bold;}
        .icon-settings { background: #aaa; color: #fff; }
        .icon-notes { background: #f8d749; }

    </style>
</head>
<body>

    <!-- Top Bar -->
    <div class="menubar">
        <div class="left-menu">
            <div style="font-size:18px">Ô£ø</div>
            <b>Finder</b>
            <span>File</span>
            <span>Edit</span>
            <span>View</span>
            <span>Go</span>
            <span>Window</span>
            <span>Help</span>
        </div>
        <div class="right-menu">
            <span>üîã 100%</span>
            <span>üì∂ WiFi</span>
            <span id="clock">Mon 9:41 AM</span>
        </div>
    </div>

    <!-- Windows Container -->
    <div id="desktop"></div>

    <!-- Dock -->
    <div class="dock-wrapper">
        <div class="dock">
            <div class="dock-app icon-finder" data-name="Finder" onclick="appManager.open('finder')">üòä</div>
            <div class="dock-app icon-term" data-name="Terminal" onclick="appManager.open('terminal')">_&gt;</div>
            <div class="dock-app icon-settings" data-name="Settings" onclick="appManager.open('settings')">‚öôÔ∏è</div>
            <div class="dock-app icon-notes" data-name="Notes" onclick="alert('Simulated App')">üìù</div>
            <div style="width:1px; background:rgba(255,255,255,0.3); margin:0 5px;"></div>
            <div class="dock-app" data-name="Trash" style="background:transparent; border:1px solid rgba(255,255,255,0.2);">üóëÔ∏è</div>
        </div>
    </div>

    <script>
        /* --- Clock --- */
        setInterval(() => {
            const d = new Date();
            const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            const time = d.toLocaleTimeString('en-US', {hour: 'numeric', minute:'2-digit'});
            document.getElementById('clock').innerText = `${days[d.getDay()]} ${time}`;
        }, 1000);

        /* --- File System (Mock) --- */
        const fileSystem = {
            "Home": {
                type: "folder",
                content: {
                    "Documents": { type: "folder", content: { "Resume.pdf": "file", "Budget.xls": "file" } },
                    "Pictures": { type: "folder", content: { "Vacation.jpg": "file", "Cat.png": "file" } },
                    "Work": { type: "folder", content: { "Project_A": "folder", "Notes.txt": "file" } },
                    "Hello.txt": "file"
                }
            }
        };

        /* --- App & Window Manager --- */
        class WindowManager {
            constructor() {
                this.desktop = document.getElementById('desktop');
                this.zIndex = 100;
                this.windows = {}; // ID -> Element
                this.idCounter = 0;
            }

            createWindow(type) {
                this.idCounter++;
                const id = `win_${this.idCounter}`;
                
                // Default Configs
                let title = "Window";
                let content = "";
                let width = 600;
                let height = 400;
                let x = 100 + (this.idCounter * 20);
                let y = 100 + (this.idCounter * 20);

                // App Logic
                if (type === 'terminal') {
                    title = "Terminal ‚Äî -zsh";
                    width = 550; height = 350;
                    content = `
                        <div class="term-body" id="term_${id}" onclick="document.getElementById('in_${id}').focus()">
                            <div class="term-line">Last login: ${new Date().toDateString()} on ttys001</div>
                            <div class="term-line">Type 'help' for commands.</div>
                            <div id="history_${id}"></div>
                            <div class="term-input-line">
                                <span class="prompt">‚ûú  ~</span>
                                <input id="in_${id}" class="term-input" type="text" autocomplete="off" spellcheck="false">
                            </div>
                        </div>
                    `;
                } else if (type === 'finder') {
                    title = "Finder";
                    content = `
                        <div class="finder-nav">
                            <span class="nav-btn" onclick="finderNav('${id}', 'back')">‚¨Ö</span>
                            <span class="path-display" id="path_${id}">Home</span>
                        </div>
                        <div class="finder-grid" id="grid_${id}"></div>
                    `;
                } else if (type === 'settings') {
                    title = "System Settings";
                    width = 500; height = 400;
                    content = `
                        <div style="padding:15px; text-align:center; font-weight:bold; border-bottom:1px solid #eee; background:#fff;">Select Wallpaper</div>
                        <div class="settings-grid">
                            <div class="wall-option" style="background-image:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?ixlib=rb-4.0.3&w=500&q=80')" onclick="setWall(this)"></div>
                            <div class="wall-option" style="background-image:url('https://images.unsplash.com/photo-1470770841072-f978cf4d019e?ixlib=rb-4.0.3&w=500&q=80')" onclick="setWall(this)"></div>
                            <div class="wall-option" style="background-image:url('https://images.unsplash.com/photo-1477346611705-65d1883cee1e?ixlib=rb-4.0.3&w=500&q=80')" onclick="setWall(this)"></div>
                            <div class="wall-option" style="background-image:url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?ixlib=rb-4.0.3&w=500&q=80')" onclick="setWall(this)"></div>
                        </div>
                    `;
                }

                // Build DOM
                const win = document.createElement('div');
                win.className = 'window';
                win.id = id;
                win.style.width = width + 'px';
                win.style.height = height + 'px';
                win.style.left = x + 'px';
                win.style.top = y + 'px';
                win.style.zIndex = ++this.zIndex;
                
                win.innerHTML = `
                    <div class="window-header" onmousedown="appManager.startDrag(event, '${id}')">
                        <div class="traffic-lights">
                            <div class="dot close" onclick="appManager.close('${id}')"></div>
                            <div class="dot min" onclick="appManager.minimize('${id}')"></div>
                            <div class="dot max" onclick="appManager.maximize('${id}')"></div>
                        </div>
                        <div class="window-title">${title}</div>
                    </div>
                    <div class="window-body">${content}</div>
                `;

                // Focus listener
                win.addEventListener('mousedown', () => {
                    win.style.zIndex = ++this.zIndex;
                });

                this.desktop.appendChild(win);
                this.windows[id] = { el: win, type: type, state: 'normal', path: ['Home'] }; // Finder needs path state

                // Post-init Setup
                if(type === 'terminal') this.initTerminal(id);
                if(type === 'finder') this.renderFinder(id);
            }

            open(type) {
                this.createWindow(type);
            }

            close(id) {
                const win = document.getElementById(id);
                win.style.opacity = '0';
                win.style.transform = 'scale(0.9)';
                setTimeout(() => win.remove(), 200);
                delete this.windows[id];
            }

            minimize(id) {
                const win = document.getElementById(id);
                win.classList.add('minimized');
                // To restore, one would usually click the dock, but for this simplified version, we will rely on a "Window" menu or just re-opening. 
                // Actually, let's make clicking the Dock icon restore existing windows.
                this.windows[id].state = 'minimized';
            }

            maximize(id) {
                const win = document.getElementById(id);
                const data = this.windows[id];
                
                if (data.state === 'maximized') {
                    // Restore
                    win.style.top = data.preRect.top;
                    win.style.left = data.preRect.left;
                    win.style.width = data.preRect.width;
                    win.style.height = data.preRect.height;
                    data.state = 'normal';
                    win.style.borderRadius = '10px';
                } else {
                    // Maximize
                    data.preRect = { top: win.style.top, left: win.style.left, width: win.style.width, height: win.style.height };
                    win.style.top = '30px'; // below menubar
                    win.style.left = '0';
                    win.style.width = '100vw';
                    win.style.height = 'calc(100vh - 30px)'; // Cover dock or not? Let's cover it for focus.
                    data.state = 'maximized';
                    win.style.borderRadius = '0';
                }
            }

            startDrag(e, id) {
                const win = document.getElementById(id);
                if(this.windows[id].state === 'maximized') return;
                
                win.style.zIndex = ++this.zIndex;
                let shiftX = e.clientX - win.getBoundingClientRect().left;
                let shiftY = e.clientY - win.getBoundingClientRect().top;

                function moveAt(pageX, pageY) {
                    win.style.left = pageX - shiftX + 'px';
                    win.style.top = pageY - shiftY + 'px';
                }

                function onMouseMove(event) {
                    moveAt(event.pageX, event.pageY);
                }

                document.addEventListener('mousemove', onMouseMove);

                document.onmouseup = function() {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.onmouseup = null;
                };
            }

            /* --- Terminal Logic --- */
            initTerminal(id) {
                const input = document.getElementById(`in_${id}`);
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const val = input.value.trim();
                        const history = document.getElementById(`history_${id}`);
                        
                        // Add old line
                        const oldLine = document.createElement('div');
                        oldLine.className = 'term-line';
                        oldLine.innerHTML = `<span class="prompt">‚ûú  ~</span> ${val}`;
                        history.appendChild(oldLine);
                        input.value = '';

                        // Process Command
                        const resp = document.createElement('div');
                        resp.className = 'term-line';
                        resp.style.color = '#ccc';

                        if (val === 'help') resp.innerText = "Available commands: help, date, clear, echo, ls, whoami";
                        else if (val === 'date') resp.innerText = new Date().toString();
                        else if (val === 'clear') history.innerHTML = ''; 
                        else if (val === 'ls') resp.innerText = "Documents  Pictures  Work  Hello.txt";
                        else if (val === 'whoami') resp.innerText = "root";
                        else if (val.startsWith('echo ')) resp.innerText = val.substring(5);
                        else if (val !== '') resp.innerText = `zsh: command not found: ${val}`;

                        if (val !== 'clear') history.appendChild(resp);
                        
                        // Scroll to bottom
                        const body = document.getElementById(`term_${id}`);
                        body.scrollTop = body.scrollHeight;
                    }
                });
                input.focus();
            }

            /* --- Finder Logic --- */
            renderFinder(id) {
                const data = this.windows[id];
                const grid = document.getElementById(`grid_${id}`);
                const pathDisplay = document.getElementById(`path_${id}`);
                
                // Navigate Data Structure
                let currentObj = fileSystem["Home"];
                // Skip Home in path for traversal logic, start inside Home
                let pathStr = data.path.join(' / ');
                pathDisplay.innerText = pathStr;

                // Traverse
                let pointer = fileSystem;
                for(let p of data.path) {
                    if(pointer[p]) pointer = pointer[p].content || pointer[p];
                }
                
                grid.innerHTML = '';

                if(pointer) {
                    for (const [name, typeObj] of Object.entries(pointer)) {
                        const type = (typeof typeObj === 'object') ? typeObj.type : 'file';
                        const item = document.createElement('div');
                        item.className = 'f-icon';
                        item.innerHTML = `
                            <div class="folder-img">${type === 'folder' ? 'üìÅ' : 'üìÑ'}</div>
                            <div class="f-name">${name}</div>
                        `;
                        if (type === 'folder') {
                            item.ondblclick = () => {
                                data.path.push(name);
                                this.renderFinder(id);
                            }
                        }
                        grid.appendChild(item);
                    }
                }
            }
        }

        const appManager = new WindowManager();

        // Finder Navigation Helper
        function finderNav(id, action) {
            const data = appManager.windows[id];
            if (action === 'back') {
                if (data.path.length > 1) {
                    data.path.pop();
                    appManager.renderFinder(id);
                }
            }
        }

        // Wallpaper Setter
        function setWall(el) {
            const url = el.style.backgroundImage.slice(5, -2);
            document.body.style.backgroundImage = `url('${url}')`;
        }

    </script>
</body>
</html>
